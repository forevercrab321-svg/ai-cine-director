# ğŸ“§ é‚®ä»¶ç³»ç»Ÿå®Œæ•´è®¾ç½®æŒ‡å—

## ğŸ¯ ä½ éœ€è¦åœ¨ Supabase æ§åˆ¶å°åšçš„äº‹æƒ…

### Step 1: ç™»å½• Supabase æ§åˆ¶å°
- æ‰“å¼€: https://app.supabase.com
- é€‰æ‹©ä½ çš„é¡¹ç›®

### Step 2: è¿›å…¥é‚®ä»¶é…ç½®
```
å·¦ä¾§èœå• â†’ Authentication 
  â†’ Providers 
  â†’ Email 
  â†’ SMTP Settings
```

### Step 3: å¡«å†™ SMTP ä¿¡æ¯

å¦‚æœä½ å·²ç»æœ‰ **Resend API Key** (æ ¼å¼: `re_...`)ï¼Œå¡«å†™ï¼š

| å­—æ®µ | å€¼ |
|------|-----|
| **Host** | `smtp.resend.com` |
| **Port** | `465` |
| **Username** | `default` |
| **Password** | `<ä½ çš„ Resend API Key>` (ä¾‹: `re_abc123...`) |
| **Sender Name** | `CINE-DIRECTOR` |
| **Sender Email** | `noreply@resend.dev` |

### Step 4: ç‚¹å‡» "Save" å¹¶æµ‹è¯•

Supabase åº”è¯¥ä¼šæ˜¾ç¤ºä¸€ä¸ª "Send Test Email" æŒ‰é’®ã€‚ç‚¹å‡»æµ‹è¯•ï¼

---

## âœ… éªŒè¯é‚®ä»¶é…ç½®æ˜¯å¦å·¥ä½œ

### æ£€æŸ¥æ¸…å•ï¼š
- [ ] SMTP é…ç½®å·²ä¿å­˜ï¼ˆé¡µé¢åº”è¯¥æ˜¾ç¤ºç»¿è‰²å¯¹å‹¾ï¼‰
- [ ] æµ‹è¯•é‚®ä»¶æˆåŠŸå‘é€
- [ ] é‚®ä»¶å‡ºç°åœ¨ä½ çš„é‚®ç®±ä¸­

### å¦‚æœè¿˜æ˜¯å¤±è´¥ï¼š

1. **æ£€æŸ¥ Resend API Key**
   - å» https://resend.com/api-keys
   - ç¡®è®¤ API Key æ ¼å¼æ˜¯ `re_` å¼€å¤´
   - ç¡®è®¤ API Key æœ‰æ•ˆï¼ˆå¤åˆ¶ç²˜è´´æ—¶æ²¡æœ‰å¤šä½™ç©ºæ ¼ï¼‰

2. **æ£€æŸ¥å‘ä»¶äººé‚®ç®±**
   - å¦‚æœç”¨è‡ªå®šä¹‰åŸŸåï¼Œéœ€è¦åœ¨ Resend ä¸­éªŒè¯
   - å»ºè®®ç”¨ `noreply@resend.dev`ï¼ˆå·²é¢„éªŒè¯ï¼‰

3. **æ£€æŸ¥ Supabase é¡¹ç›®**
   - ç¡®è®¤ä½ åœ¨æ­£ç¡®çš„é¡¹ç›®ä¸­ï¼ˆURL ä¸­çš„ `gtxgkdsayswonlewqfzj` åº”è¯¥åŒ¹é…ï¼‰

---

## ğŸ”§ ä»£ç ç«¯å·²ç»é…ç½®å®Œæˆçš„éƒ¨åˆ†

âœ… å‰ç«¯ (`AuthPage.tsx`): è°ƒç”¨ `supabase.auth.signInWithOtp()` 
âœ… åç«¯ (`server/index.ts`): æ·»åŠ äº† `/api/auth/ensure-user` ç«¯ç‚¹
âœ… ç¯å¢ƒå˜é‡: Supabase URL å’Œ Key å·²é…ç½®

**ç°åœ¨çš„è´£ä»»åœ¨ Supabase æ§åˆ¶å°çš„é‚®ä»¶é…ç½®ä¸Šï¼**

---

## ğŸš€ å®Œæ•´æµç¨‹éªŒè¯

å½“é‚®ä»¶é…ç½®æ­£ç¡®åï¼š

1. ç”¨æˆ·è®¿é—®ç™»å½•é¡µ
2. è¾“å…¥é‚®ç®± â†’ ç‚¹å‡» "Send Verification Code"
3. Supabase Auth è°ƒç”¨ SMTP â†’ Resend å‘é€é‚®ä»¶
4. ç”¨æˆ·æ”¶åˆ°é‚®ä»¶é“¾æ¥æˆ– OTP ç 
5. ç‚¹å‡»é“¾æ¥æˆ–è¾“å…¥ OTP â†’ ç™»å½•æˆåŠŸ

---

## âš ï¸ å¸¸è§é”™è¯¯

| é”™è¯¯ | åŸå›  | è§£å†³ |
|------|------|------|
| "Error sending magic link email" | SMTP æœªé…ç½®æˆ–å¤±è´¥ | æ£€æŸ¥ Supabase æ§åˆ¶å°é‚®ä»¶è®¾ç½® |
| "Invalid API Key" | Resend Key æ ¼å¼é”™è¯¯ | ç¡®è®¤ä»¥ `re_` å¼€å¤´ï¼Œæ²¡æœ‰ç©ºæ ¼ |
| "Domain not verified" | é‚®ç®±åŸŸåæœªéªŒè¯ | ç”¨ `noreply@resend.dev` æˆ–åœ¨ Resend éªŒè¯åŸŸå |

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœæŒ‰ç…§è¿™ä¸ªæŒ‡å—è¿˜æ˜¯ä¸è¡Œï¼Œå‘Šè¯‰æˆ‘ï¼š
1. Supabase æ§åˆ¶å°ä¸­é‚®ä»¶é…ç½®é¡µé¢çš„æˆªå›¾
2. Resend API Key çš„å‰ 10 ä¸ªå­—ç¬¦ (ä¾‹: `re_abc123...`)
3. ä½ çœ‹åˆ°çš„å…·ä½“é”™è¯¯ä¿¡æ¯
