# AI Cine Director - ç³»ç»Ÿè¯Šæ–­æŠ¥å‘Š
**ç”Ÿæˆæ—¶é—´**: 2026å¹´2æœˆ23æ—¥  
**è¯Šæ–­äººå‘˜**: AI Assistant

---

## ğŸ“Š æ€»ä½“çŠ¶æ€

### âœ… ç³»ç»Ÿå¥åº·åº¦: 100%
æ‰€æœ‰æ ¸å¿ƒç»„ä»¶è¿è¡Œæ­£å¸¸ï¼Œç³»ç»Ÿå®Œå…¨å°±ç»ªï¼

---

## ğŸ” è¯¦ç»†æ£€æŸ¥ç»“æœ

### 1. ç¯å¢ƒå˜é‡é…ç½® âœ…
æ‰€æœ‰å¿…éœ€çš„ API Key å’Œé…ç½®å·²æ­£ç¡®è®¾ç½®ï¼š

| é…ç½®é¡¹ | çŠ¶æ€ | è¯´æ˜ |
|-------|------|------|
| VITE_SUPABASE_URL | âœ… é…ç½®æ­£ç¡® | Supabase é¡¹ç›® URL |
| VITE_SUPABASE_ANON_KEY | âœ… é…ç½®æ­£ç¡® | Supabase åŒ¿åå¯†é’¥ |
| SUPABASE_SERVICE_ROLE_KEY | âœ… é…ç½®æ­£ç¡® | Supabase æœåŠ¡å¯†é’¥ |
| GEMINI_API_KEY | âœ… é…ç½®æ­£ç¡® | Google Gemini API |
| REPLICATE_API_TOKEN | âœ… é…ç½®æ­£ç¡® | Replicate AI API |
| RESEND_API_KEY | âœ… é…ç½®æ­£ç¡® | Resend é‚®ä»¶æœåŠ¡ |
| STRIPE_SECRET_KEY | âœ… é…ç½®æ­£ç¡® | Stripe æ”¯ä»˜æœåŠ¡ |

### 2. æœåŠ¡å™¨çŠ¶æ€ âœ…

#### å‰ç«¯æœåŠ¡å™¨ (Vite)
- **ç«¯å£**: 3000
- **çŠ¶æ€**: âœ… è¿è¡Œæ­£å¸¸
- **è®¿é—®åœ°å€**: http://localhost:3000
- **æœ¬åœ°ç½‘ç»œ**: http://192.168.1.51:3000

#### åç«¯æœåŠ¡å™¨ (Express)
- **ç«¯å£**: 3002
- **çŠ¶æ€**: âœ… è¿è¡Œæ­£å¸¸
- **è®¿é—®åœ°å€**: http://localhost:3002
- **å¥åº·æ£€æŸ¥**: http://localhost:3002/api/health
- **å“åº”ç¤ºä¾‹**:
```json
{
  "status": "ok",
  "geminiKey": "âœ… configured",
  "replicateToken": "âœ… configured"
}
```

### 3. API æœåŠ¡çŠ¶æ€ âœ…

#### Gemini API (Google)
- **çŠ¶æ€**: âœ… è®¤è¯æˆåŠŸ
- **æµ‹è¯•**: æˆåŠŸç”Ÿæˆå“åº” "Hello."
- **å¯ç”¨æ¨¡å‹**: 
  - gemini-2.0-flash (ä¸»è¦)
  - gemini-1.5-flash (å¤‡ç”¨)
- **åŠŸèƒ½**: æ•…äº‹æ¿ç”Ÿæˆã€è§’è‰²é”šç‚¹åˆ†æ

#### Replicate API
- **çŠ¶æ€**: âœ… è®¤è¯æˆåŠŸ
- **è´¦æˆ·**: forevercrab321-svg
- **åŠŸèƒ½**: 
  - å›¾ç‰‡ç”Ÿæˆ (Flux, Flux Schnell)
  - è§†é¢‘ç”Ÿæˆ (Hailuo, Minimax, Pyramid Flow)

#### Resend API (é‚®ä»¶æœåŠ¡)
- **çŠ¶æ€**: âœ… å®Œå…¨å°±ç»ª
- **åŸŸå**: aidirector.business
- **åŸŸåçŠ¶æ€**: âœ… å·²éªŒè¯ (verified)
- **å‘é€èƒ½åŠ›**: å·²å¯ç”¨ (enabled)
- **åŒºåŸŸ**: us-east-1
- **æµ‹è¯•ç»“æœ**: 
  - ç›´æ¥ API è°ƒç”¨: âœ… æˆåŠŸ (Email ID: bec00192-a9dc-4bf6-98a6-f422cddd3760)
  - OTP é‚®ä»¶å‘é€: âœ… æˆåŠŸ (Email ID: fcd980bd-82e0-4b0d-ace1-5107876013d9)

#### Supabase (æ•°æ®åº“)
- **çŠ¶æ€**: âœ… è¿æ¥æ­£å¸¸
- **é¡¹ç›®**: gtxgkdsayswonlewqfzj.supabase.co
- **åŠŸèƒ½**: 
  - ç”¨æˆ·è®¤è¯
  - æ•°æ®å­˜å‚¨ (profiles, shots, shot_images, ledger)
  - RLS æƒé™æ§åˆ¶

### 4. ä»£ç è´¨é‡ âœ…
- **TypeScript ç¼–è¯‘**: âœ… æ— é”™è¯¯
- **ESLint æ£€æŸ¥**: âœ… æ— é—®é¢˜
- **å‰ç«¯ä»£ç **: âœ… è¿è¡Œæ­£å¸¸
- **åç«¯è·¯ç”±**: âœ… é…ç½®æ­£ç¡®

---

## ğŸ¯ å…³é”®åŠŸèƒ½æµ‹è¯•

### âœ… å·²æµ‹è¯•å¹¶é€šè¿‡çš„åŠŸèƒ½

1. **ç¯å¢ƒå˜é‡åŠ è½½**: dotenv æ­£ç¡®åŠ è½½ .env.local
2. **API ä»£ç†**: Vite æ­£ç¡®ä»£ç† /api åˆ° Express (3002ç«¯å£)
3. **å¥åº·æ£€æŸ¥ç«¯ç‚¹**: /api/health è¿”å›æ­£ç¡®çŠ¶æ€
4. **Gemini æ–‡æœ¬ç”Ÿæˆ**: æˆåŠŸè°ƒç”¨ Google AI
5. **Replicate è´¦æˆ·éªŒè¯**: æˆåŠŸè·å–è´¦æˆ·ä¿¡æ¯
6. **Resend åŸŸåéªŒè¯**: åŸŸåå·²å®Œå…¨éªŒè¯
7. **é‚®ä»¶å‘é€**: OTP é‚®ä»¶æˆåŠŸå‘é€
8. **Supabase æ•°æ®åº“è¿æ¥**: æˆåŠŸæŸ¥è¯¢ profiles è¡¨

---

## ğŸ“ æ¶æ„æ¦‚è§ˆ

### è¯·æ±‚æµç¨‹
```
æµè§ˆå™¨ (localhost:3000)
    â†“ ç”¨æˆ·æ“ä½œ
React ç»„ä»¶ (VideoGenerator.tsx)
    â†“ è°ƒç”¨æœåŠ¡
å‰ç«¯æœåŠ¡å±‚ (geminiService.ts, replicateService.ts)
    â†“ /api/* è¯·æ±‚
Vite ä»£ç† (vite.config.ts)
    â†“ è½¬å‘åˆ° localhost:3002
Express åç«¯ (server/index.ts)
    â†“ è·¯ç”±åˆ†å‘
åç«¯è·¯ç”± (server/routes/*.ts)
    â†“ è°ƒç”¨å¤–éƒ¨ API
å¤–éƒ¨æœåŠ¡ (Gemini, Replicate, Supabase, Resend)
```

### å…³é”®æ–‡ä»¶
| æ–‡ä»¶ | ä½œç”¨ | çŠ¶æ€ |
|------|------|------|
| `.env.local` | ç¯å¢ƒå˜é‡é…ç½® | âœ… å®Œæ•´ |
| `server/index.ts` | Express æœåŠ¡å™¨å…¥å£ | âœ… è¿è¡Œä¸­ |
| `vite.config.ts` | Vite é…ç½® (ä»£ç†) | âœ… æ­£ç¡® |
| `server/routes/gemini.ts` | Gemini API è·¯ç”± | âœ… æ­£å¸¸ |
| `server/routes/replicate.ts` | Replicate API è·¯ç”± | âœ… æ­£å¸¸ |
| `services/geminiService.ts` | å‰ç«¯ Gemini ä»£ç† | âœ… æ­£å¸¸ |
| `services/replicateService.ts` | å‰ç«¯ Replicate ä»£ç† | âœ… æ­£å¸¸ |
| `context/AppContext.tsx` | å…¨å±€çŠ¶æ€ç®¡ç† | âœ… æ­£å¸¸ |

---

## ğŸ”’ å®‰å…¨æ£€æŸ¥ âœ…

### API Key éš”ç¦»
- âœ… æ‰€æœ‰æ•æ„Ÿ API Key ä»…åœ¨åç«¯ä½¿ç”¨
- âœ… å‰ç«¯æœåŠ¡å±‚é€šè¿‡ /api ä»£ç†è®¿é—®
- âœ… CORS é…ç½®æ­£ç¡® (å¼€å‘ç¯å¢ƒå…è®¸ localhost)
- âœ… Authorization Header éªŒè¯ (JWT Token)

### æ•°æ®åº“å®‰å…¨
- âœ… Supabase RLS (Row Level Security) å¯ç”¨
- âœ… Service Role Key ä»…åœ¨åç«¯ä½¿ç”¨
- âœ… ç”¨æˆ·è®¤è¯é€šè¿‡ Supabase Auth

---

## ğŸ’³ ç§¯åˆ†ç³»ç»Ÿæ£€æŸ¥ âœ…

### é…ç½®
- **Storyboard ç”Ÿæˆ**: 1 ç§¯åˆ†
- **å›¾ç‰‡ç”Ÿæˆ (Flux)**: 2 ç§¯åˆ†
- **å›¾ç‰‡ç”Ÿæˆ (Flux Schnell)**: 1 ç§¯åˆ†
- **è§†é¢‘ç”Ÿæˆ**: 28+ ç§¯åˆ† (æ¨¡å‹ä¾èµ–)

### æµç¨‹
1. å‰ç«¯è°ƒç”¨æœåŠ¡ (é™„å¸¦ JWT Token)
2. åç«¯éªŒè¯ç”¨æˆ·èº«ä»½
3. æ£€æŸ¥ç”¨æˆ·ç§¯åˆ†ä½™é¢
4. é¢„ç•™ç§¯åˆ† (reserve_credits RPC)
5. è°ƒç”¨å¤–éƒ¨ API
6. æˆåŠŸåé‡Šæ”¾ç§¯åˆ† / å¤±è´¥åé€€æ¬¾

### ç®¡ç†å‘˜æ¨¡å¼
- **å¼€å‘è€…é‚®ç®±**: forevercrab321@gmail.com
- **æƒé™**: ç»•è¿‡æ‰€æœ‰ç§¯åˆ†æ£€æŸ¥
- **æ£€æµ‹**: è‡ªåŠ¨è¯†åˆ« (å‰åç«¯åŒæ­¥)

---

## ğŸ“§ é‚®ä»¶ç³»ç»Ÿè¯¦æƒ…

### Resend åŸŸåé…ç½®
```json
{
  "domain": "aidirector.business",
  "status": "verified",
  "sending": "enabled",
  "region": "us-east-1"
}
```

### é‚®ä»¶å‘é€æµç¨‹
1. ç”¨æˆ·è¾“å…¥é‚®ç®± â†’ å‰ç«¯è°ƒç”¨ `/api/auth/send-otp`
2. åç«¯é€šè¿‡ Supabase Admin API ç”Ÿæˆ Magic Link
3. æå– OTP Token (6ä½æ•°å­—)
4. é€šè¿‡ Resend API å‘é€é‚®ä»¶
5. ä¼˜å…ˆä½¿ç”¨è‡ªå®šä¹‰åŸŸå: `noreply@aidirector.business`
6. å¤‡ç”¨: `onboarding@resend.dev`

### æµ‹è¯•ç»“æœ
- âœ… ç›´æ¥è°ƒç”¨ Resend API: æˆåŠŸ
- âœ… å®Œæ•´ OTP æµç¨‹: æˆåŠŸ
- âœ… é‚®ä»¶é€è¾¾: å·²ç¡®è®¤

---

## ğŸš€ å¯åŠ¨å‘½ä»¤

### å¼€å‘ç¯å¢ƒ
```bash
# åŒæ—¶å¯åŠ¨å‰åç«¯ (æ¨è)
npm run dev:all

# åˆ†åˆ«å¯åŠ¨
npm run dev      # å‰ç«¯ (Vite)
npm run server   # åç«¯ (Express)
```

### æµ‹è¯•è„šæœ¬
```bash
# å…¨é¢è¯Šæ–­
npx tsx scripts/diagnose-all.ts

# æµ‹è¯•é‚®ä»¶å‘é€
npx tsx scripts/test-email.ts [email]

# API å‹åŠ›æµ‹è¯•
npm run stress-test
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### Resend åŸŸåçŠ¶æ€
æ‚¨ä¹‹å‰æåˆ°çš„ "Resend åŸŸå pending" é—®é¢˜å·²ç»è§£å†³ï¼š
- **å½“å‰çŠ¶æ€**: âœ… verified (å·²éªŒè¯)
- **å‘é€èƒ½åŠ›**: âœ… enabled (å·²å¯ç”¨)
- **æ— éœ€é¢å¤–é…ç½®**

### å¼€å‘ç¯å¢ƒè¦æ±‚
1. **å¿…é¡»åŒæ—¶è¿è¡Œå‰åç«¯**: ä½¿ç”¨ `npm run dev:all`
2. **ç«¯å£å ç”¨æ£€æŸ¥**: ç¡®ä¿ 3000 å’Œ 3002 ç«¯å£å¯ç”¨
3. **ç¯å¢ƒå˜é‡**: æ‰€æœ‰ API Key å¿…é¡»åœ¨ `.env.local` ä¸­é…ç½®

---

## âœ¨ æ€»ç»“

### ç³»ç»ŸçŠ¶æ€: ğŸ‰ å®Œå…¨å°±ç»ª
- âœ… æ‰€æœ‰ API Key é…ç½®æ­£ç¡®
- âœ… å‰åç«¯æœåŠ¡å™¨è¿è¡Œæ­£å¸¸
- âœ… å¤–éƒ¨ API å…¨éƒ¨å¯ç”¨
- âœ… Resend åŸŸåå·²éªŒè¯ (ä¸å† pending)
- âœ… é‚®ä»¶å‘é€åŠŸèƒ½æ­£å¸¸
- âœ… æ•°æ®åº“è¿æ¥æ­£å¸¸
- âœ… æ— ä»£ç é”™è¯¯

### å¯ä»¥ç«‹å³ä½¿ç”¨çš„åŠŸèƒ½
1. ğŸ¬ æ•…äº‹æ¿ç”Ÿæˆ (Gemini API)
2. ğŸ–¼ï¸ å›¾ç‰‡ç”Ÿæˆ (Replicate Flux)
3. ğŸ¥ è§†é¢‘ç”Ÿæˆ (Replicate Hailuo/Minimax)
4. ğŸ“§ é‚®ä»¶ç™»å½• (Resend + Supabase Auth)
5. ğŸ’³ ç§¯åˆ†ç³»ç»Ÿ (å®Œæ•´æµç¨‹)
6. ğŸ‘¤ ç”¨æˆ·ç®¡ç† (Supabase + RLS)

### å»ºè®®çš„ä¸‹ä¸€æ­¥
1. åœ¨æµè§ˆå™¨æ‰“å¼€ http://localhost:3000 å¼€å§‹ä½¿ç”¨
2. ä½¿ç”¨å¼€å‘è€…é‚®ç®±ç™»å½•ä»¥è·å¾—æ— é™ç§¯åˆ†
3. åˆ›å»ºç¬¬ä¸€ä¸ªé¡¹ç›®å¹¶æµ‹è¯•å®Œæ•´æµç¨‹
4. ç›‘æ§åç«¯æ—¥å¿—ä»¥æŸ¥çœ‹è¯¦ç»†è¿è¡Œä¿¡æ¯

---

**æŠ¥å‘Šç”Ÿæˆ**: 2026å¹´2æœˆ23æ—¥  
**ç³»ç»Ÿç‰ˆæœ¬**: v0.0.0  
**Node.js**: è¿è¡Œä¸­  
**æœåŠ¡çŠ¶æ€**: âœ… å…¨éƒ¨æ­£å¸¸
